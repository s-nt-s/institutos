<!DOCTYPE html>
<html lang="es">
	<head>
		<base target="_blank" />
    <meta charset="UTF-8">
    <title>Centros educativos en Madrid</title>
		<script type="text/javascript">
			if (document.location.protocol && document.location.hostname && document.location.protocol.startsWith("http")) {
				if (document.location.hostname!="institutos.ml") {
					window.location.replace("https://institutos.ml");
				}
			}
		</script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="stylesheet" href="main.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
    integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
    crossorigin=""></script>
    <link rel="stylesheet" href="sidebar/leaflet-sidebar.css" />
    <script src="sidebar/leaflet-sidebar.js"></script>

		<script src="geotransporte.js"></script>
    <script src="geocentros.js"></script>
    <script src="extend.js"></script>
    <script src="main.js" defer="defer"></script>
		<!-- Matomo -->
		<script type="text/javascript">
		if (document.location.hostname=="institutos.ml") {
		  var _paq = window._paq || [];
		  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="https://institutosml.matomo.cloud/";
		    _paq.push(['setTrackerUrl', u+'matomo.php']);
		    _paq.push(['setSiteId', '1']);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src='//cdn.matomo.cloud/institutosml.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
		  })();
		}
		</script>
		<!-- End Matomo Code -->
	</head>
	<body>
		<div id="sidebar" class="sidebar collapsed">
        <!-- Nav tabs -->
        <div class="sidebar-tabs">
            <ul role="tablist">
                <li title="Información"><a href="#home" role="tab"><i class="fa fa-info-circle"></i></a></li>
                <li title="Filtros"><a href="#settings" role="tab"><i class="fa fa-gear"></i></a></li>
								<li title="Transporte"><a href="#transporte" role="tab"><i class="fa fa-subway"></i></a></li>
								<li title="Mandar mails" id="lkMessages"><a href="#messages" role="tab"><i class="fa fa-envelope"></i></a></li>
                <li title="Tu lista" class="tulista"><a href="#lista" role="tab"><i class="fa fa-pencil-square-o"></i><span id="count">{{count}}</span></a></li>
                <li title="Contacto, correciones y sugerencias"><a href="#contacto" role="tab"><i class="fa fa-question-circle"></i></a></li>
								<li title="Descarga tu lista"><a id="download" data-href="data:text/plain;charset=utf-8," href="data:text/plain;charset=utf-8," download="centros.txt" role="tab"><i class="fa fa fa-cloud-download"></i></a></li>
            </ul>

            <ul role="tablist">
                <li title="GitHub"><a href="https://github.com/s-nt-s/institutos-map" role="tab" target="_blank"><i class="fa fa-github"></i></a></li>
            </ul>
        </div>

        <!-- Tab panes -->
        <div class="sidebar-content">
            <div class="sidebar-pane" id="home">
                <h1 class="sidebar-header">
                    Información
                    <span class="sidebar-close"><i class="fa fa-caret-left"></i></span>
                </h1>
								<div class="content">
									<h2>Leyenda</h2>
									<p>Se han usado los siguientes iconos para dar información extra:</p>
									<ul class="leyenda">
										<li class="liimg"><img atl="{{lgd[0]}}" src="{{lgd[3]}}"/> <span>Centro de especial dificultad</span></li>
										<li class="liimg"><img atl="{{lgd[1]}}" src="{{lgd[4]}}"/> <span>Centro con turnos nocturnos</span></li>
										<li class="liimg"><img atl="{{lgd[2]}}" src="{{lgd[5]}}"/> <span>Color por defecto</span></li>
									  <li>Y las mismas marcas pero con un punto negro en el centro
										cuando además se da alguna característica especial como
										bilingüismo, excelencia o innovación tecnológica</li>
										<li>Cada marca es sustituida por una chincheta
											cuando se selecciona, y por un circulo pequeño cuando
											se descarta</li>
									</ul>
									<h2>Objetivo</h2>
									<p>El objetivo de este mapa es ayudar a elegir destino
										a los funcionarios de carrera o interinos del cuerpo 0590,
										profesores de enseñanza secundaria, en la Comunidad de Madrid.
										</p>
									<h2>Fuentes</h2>
									<p>Para ello se han usado las siguientes fuentes:</p>
									<ul>
								      <li>
												<a href="{{indice.convocatoria}}">La última convocatoría</a></i>
											</li>
								      <li>
												<a href="{{indice.anexo29}}">El anexo 29</a></i>
											</li>
								      <li>
												<a href="{{indice.centros}}">El buscador de centros</a></i>
											</li>
											<li>
												<a href="{{indice.transporte.opendata}}">El portal de datos abiertos de CRTM</a>
											</li>
									</ul>
									<p>
										De todos los centros que devuelve <a href="{{indice.centros}}">el buscador</a> solo se muestran
										aquellos que son de alguno de los siguientes tipos:
									</p>
									<ul>
					        {% for key, text in tipos %}
										<li>{{text}}</li>
									{% endfor %}
									</ul>
									<p>
										y que (en caso de que este la información disponible) ofrezcan al menos alguna de estas etapas educativas:									</p>
									<ul>
					        {% for etapa in etapas %}
										<li>{{etapa}}</li>
									{% endfor %}
									</ul>

									{% if notlatlon %}
									<p>
										A excepción de los siguientes que han tenido que ser descartados por no tener cooredandas geográficas:
									</p>
									<ul>
										{% for id, nombre, info in notlatlon %}
											<li><a href="{{info}}">{{id}} {{nombre}}</a></li>
										{% endfor %}
									</ul>
									{% endif %}
								</div>
	            </div>
            <div class="sidebar-pane" id="settings">
                <h1 class="sidebar-header">Filtros<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
                <div class="content filter">
									<p>
										Los centros seleccionados siempre apareceran, independiemtemente del filtro definido en esta sección.
									</p>
								{#
									{% set tt1 = "Escriba aquí los códigos de los centros que quiere que se muestren independientemente de los filtros" -%}
									{% set tt2 = "Escriba aquí los códigos de los centros que quiere que no se muestren independientemente de los filtros" -%}
                <p>
                  <label for="siempre">Mostrar siempre</label>: <input type="text" id="siempre" pattern="[0-9 ]+" title="{{tt1}}" placeholder="{{tt1}}"/>
                </p>
                <p>
                  <label for="nunca">Ocultar siempre</label>: <input type="text" id="nunca" pattern="[0-9 ]+" title="{{tt2}}" placeholder="{{tt2}}"/>
                </p>
								#}
                <fieldset id="tipos">
                  <legend>Tipos</legend>
					        {% for key, text in tipos %}
										<input title="{{text}}" id="t{{key}}" type="checkbox" checked="checked"/> <label for="t{{key}}">{{text}}</label><br/>
									{% endfor %}
                </fieldset>
                <fieldset id="nocturnos">
                  <legend>Nocturnos en</legend>
					        {% for text in nocturnos %}
										  <input title="{{text}}" id="n{{loop.index}}" type="checkbox" checked="checked"/> <label for="n{{loop.index}}">{{text}}</label><br/>
									{% endfor %}
                </fieldset>
                <fieldset id="etapas">
                  <legend>Etapas eductativas</legend>
					        {% for text in etapas %}
										  <input title='{{text}}' id="et{{loop.index}}" type="checkbox" checked="checked"/> <label for="et{{loop.index}}">{{text}}</label><br/>
									{% endfor %}
									{% if sin_etapas %}
											<input title='Centros sin información sobre etapas educativas' id="etNull" type="checkbox" checked="checked"/> <label for="etNull"><em>Centros sin información sobre etapas educativas</em></label><br/>
									{% endif %}
                </fieldset>
                <fieldset id="comunicacion">
                  <legend>Transporte</legend>
									<label for="kms">Mostrar solo centros a menos de </label> <input type="number" id="kms" pattern="[0-9]+" title="Deje vacio el campo para no filtrar" width="2em"/>
									<label for="kms">metros de una estación de metro, metro ligero o cercanias</label>
                </fieldset>
                <fieldset id="otros">
                  <legend>Otras condiciones especiales</legend>
										  <input id="dificultad" type="checkbox" checked="checked" title="Centro de especial dificultad"/> <label for="dificultad">Centro de especial dificultad</label><br/>
										  <input id="excelencia" type="checkbox" checked="checked" title="Centro o aula de excelencia"/> <label for="excelencia">Centro o aula de excelencia</label><br/>
											<input id="bilingue" type="checkbox" checked="checked" title="Bilingüismo o sección de idioma"/> <label for="bilingue">Bilingüismo o sección de idioma</label><br/>
											<input id="tecnico" type="checkbox" checked="checked" title="Instituto de innovación tecnológica"/> <label for="tecnico">Instituto de innovación tecnológica</label>
                </fieldset>
                </div>
            </div>

						 <div class="sidebar-pane" id="messages">
						      <h1 class="sidebar-header">Mandar un mail<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
									<div class="content">
										<p>
											Puedes mandar un correo electrónico a todos los centros que se estan motrando en el mapa
											<a id="maillink" data-href="mailto:?subject=Consulta%20en%20relación%20al%20concurso%20de%20traslados&" href="mailto:?subject=Consulta%20en%20relacción%20al%20concurso%20de%20traslados&bcc={{mails}}">pulsando en
												este enlace</a>
										</p>
										<p>
											También puedes mandar mails desde la pestaña <i class="fa fa-pencil-square-o"></i> Lista.
										</p>
									</div>
						</div>

						 <div class="sidebar-pane" id="lista">
						      <h1 class="sidebar-header">Tu lista<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
									<div class="content">
										<p>
											Para ordenar los centros por cercania a un punto geográfico haz click en el lugar deseado sobre el mapa mientras pulsas la tecla <b>Control</b>.
										</p>
										<h2>Centros seleccionados</h2>
										<div id="cSel">

										</div>
										<h2>Centros visibles</h2>
										<div id="cShw">

										</div>
										<h2>Centros ocultos</h2>
										<div id="cHdn">

										</div>
										<h2>Centros descartados</h2>
										<div id="cDsc">

										</div>
									</div>
						</div>


					 <div class="sidebar-pane" id="contacto">
					      <h1 class="sidebar-header">Contacto<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
								<div class="content">
									<p>
						      <svg height="32" class="octicon octicon-law license-summary-octicon float-left mr-2" viewBox="0 0 14 16" version="1.1" width="28" aria-hidden="true"><path fill-rule="evenodd" d="M7 4c-.83 0-1.5-.67-1.5-1.5S6.17 1 7 1s1.5.67 1.5 1.5S7.83 4 7 4zm7 6c0 1.11-.89 2-2 2h-1c-1.11 0-2-.89-2-2l2-4h-1c-.55 0-1-.45-1-1H8v8c.42 0 1 .45 1 1h1c.42 0 1 .45 1 1H3c0-.55.58-1 1-1h1c0-.55.58-1 1-1h.03L6 5H5c0 .55-.45 1-1 1H3l2 4c0 1.11-.89 2-2 2H2c-1.11 0-2-.89-2-2l2-4H1V5h3c0-.55.45-1 1-1h4c.55 0 1 .45 1 1h3v1h-1l2 4zM2.5 7L1 10h3L2.5 7zM13 10l-1.5-3-1.5 3h3z"></path></svg>
						        Esta obra esta bajo una licencia <a href="https://github.com/s-nt-s/institutos-map/blob/master/LICENSE">GNU General Public License v3.0</a>, por lo tanto eres libre de hacer cualquier modificación o mejora.
						      </p>
									<p>Si quieres que tus mejoras, sugerencias o correciones sean incluidas
										lo mejor es que me hagas un <code>pull Requests</code>, o des de alta un <code>issue</code>, en
									 <a href="https://github.com/s-nt-s/institutos-map">github</a>; pero si eso te suena a chino
										puedes simplemente contactame via xmpp en <a title="Ni WhatsApp, ni Telegram, ni mierdas. XMPP." href="xmpp:git@suchat.org">git@suchat.org</a>
										o via mail en <a href="mailto:santos82h@gmail.com">santos82h@gmail.com</a>.
									</p>
									<p>
										Por otro lado, si tienes conocimientos de programación y quieres colaborar pero no se te ocurre como,
										echale un vistazo a los <a href="https://github.com/s-nt-s/institutos-map/issues">issues abiertos</a>,
										especialmente a aquellos que estan etiquetados como <code>help wanted</code>.
									</p>
								</div>
					</div>
					 <div class="sidebar-pane" id="transporte">
					      <h1 class="sidebar-header">Transporte<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
								<div class="content">
									<p>
										<input type="checkbox" id="estaciones" />
										<label for="estaciones">Mostrar estaciones de las lineas seleccionadas (*)</label>
									</p>
					        {% for id, lineas in transporte.items() %}
									<fieldset class="{{id}}">
										<legend>
											{{id.replace("_", " ").capitalize()}}
										</legend>
										{% for l in lineas %}
											<input type="checkbox" id="{{id}}_{{l.linea}}" /> <label for="{{id}}_{{l.linea}}">{{l.linea}}</label><br/>
										{% endfor %}
									</fieldset>
									{% endfor %}
									<p>
										(*) La ubicación de las estaciones es orientativa y puede haber otros
										accesos que no esten representados.
									</p>
								</div>
						</div>

        </div>
    </div>

		<div id="map" class="sidebar-map"></div>

  </body>

</html>
